<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Automating Git deployment setup with shell scripts</title><meta name=description content="Create a small shell script to automate the process of setting up your staging server directory."><meta name=viewport content="width=device-width"><link rel=stylesheet href=/css/main.d4c5.css><link href="http://fonts.googleapis.com/css?family=Ubuntu:400,700" rel=stylesheet type=text/css><script src=/js/vendor/modernizr.9a8f.js></script><!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script><![endif]--><meta name=twitter:site content=richardwestenra><meta name=twitter:title content="Automating Git deployment setup with shell scripts"><meta name=twitter:description content="Create a small shell script to automate the process of setting up your staging server directory."><meta itemprop=name content="Automating Git deployment setup with shell scripts"><meta itemprop=description content="Create a small shell script to automate the process of setting up your staging server directory."><meta property=og:title content="Automating Git deployment setup with shell scripts"><meta property=og:description content="Create a small shell script to automate the process of setting up your staging server directory."><link rel=alternate type=application/atom+xml title="Richard Westenra | Web designer &amp; front-end developer" href=http://richardwestenra.com/atom.xml></head><body class=default><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-9812933-1', 'auto');
  ga('send', 'pageview');</script><div class=container><header class=header role=banner><div class=wrapper><h1 class=title><a title=Home href="/">richardwestenr<i class=icon-home></i><span>a</span>.com</a></h1><a href=#nav class="mobile-only hamburger" role=button><i class=icon-menu></i><span>Menu</span></a><ul id=nav role=navigation><li><a href="/blog/"><i class=icon-comment></i><span>Blog</span></a></li><li><a href="/portfolio/"><i class=icon-briefcase></i><span>Portfolio</span></a></li><li><a href="/linkblog/"><i class=icon-link></i><span>Linkblog</span></a></li><li><a href=mailto:richard@richardwestenra.com target=_blank><i class=icon-mail></i><span>Send me an email</span></a></li><li><a href=http://github.com/richardwestenra target=_blank><i class=icon-github></i><span>Fork me on Github</span></a></li><li><a href=http://twitter.com/richardwestenra target=_blank><i class=icon-twitter></i><span>Follow me on Twitter</span></a></li><li><a href=# role=button class=configBtn><i class=icon-cog></i><span>Site settings</span></a></li></ul></div></header><!--[if lt IE 8]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><noscript><p class=browsehappy>For full functionality of this site it is necessary to enable JavaScript. Here are <a href="http://www.enable-javascript.com/" target=_blank>instructions how to enable JavaScript in your web browser</a>.</p></noscript><main class=wrapper><article class="post default"><h2 class=postHeader>Automating Git deployment setup with shell scripts</h2><p class=meta>Published 24 Feb 2015</p><p>My job involves creating new projects every other week, and pushing them to a live staging server for testing and client presentations. I previously used FTP to upload my projects, but FTP can be risky as it&#39;s very easy to accidentally delete/overwrite the wrong files. FTP also makes it difficult to keep track of which files you&#39;ve changed, so you often end up uploading more files than you need to, which makes deployment take longer than it needs to.</p><p>For this reason, I switched to using Git to deploy new projects. Once you&#39;ve got it set up, all you need to do is run <code>git push remotename master</code> (or <code>grunt deploy</code> if you use Grunt) to deploy your latest changes to the server, and it will only transmit the code that has changed, reducing upload time. I like <a href=http://curtisblackwell.com/blog/my-deploy-method-brings-most-of-the-boys-to-the-yard>Curtis Blackwell&#39;s method</a>, which uses <a href="http://gthooks.com/">post-receive hooks</a>. His article recommends using <a href=https://github.com/robwierzbowski/grunt-build-control>grunt-build-control</a> for deployment (as do I), but it&#39;s not strictly necessary if you&#39;d rather avoid using Grunt.</p><p>The only tricky part about using Git for deployment is that setting up each new project requires you to enter several rather unmemorable terminal commands, which is cumbersome and easy to mess up. Since I was doing this frequently, I decided to automate the process with a simple shell script. I&#39;ve pasted an example below: Feel free to modify it however you like.</p><h3>Create a shell script</h3><p>Copy the following to a text document and save it as a shell file. I called mine <strong>gitsetup.sh</strong>:</p><div class=highlight><pre><code class=language-text data-lang=text># This script sets up a Git post receive hook for easy deployment.
# Created by Richard Westenra
# See http://richardwestenra.com/automating-git-deployment/

echo &quot;Hey there! This script sets up a Git post-receive hook for easy deployment.&quot;
echo &quot;Please enter the full path for the project, including the project directory.&quot;
echo &quot;Do not include preceding or trailing slashes.&quot;
# Get the folder path
read path

# echo verbose commands
set -x

# Create the repo directory
mkdir -p $path/.git
cd $path/.git

# Run git init and set up git hooks in the directory
git init --bare
cat &gt; hooks/post-receive &lt;&lt; EOF
#!/bin/sh
GIT_WORK_TREE=/$path git checkout -f
EOF
chmod +x hooks/post-receive

set +x
# We&#39;re done!
echo &quot;Git post receive hook is set up at $path/.git&quot;
</code></pre></div><p>Place this file in the root of your staging server.</p><h3>Set up a new directory</h3><p>Here is the workflow for setting up a new directory to deploy your project to:</p><ol><li><a href=http://www.wikihow.com/SSH-to-a-Server>SSH into the test server</a>. You&#39;ll want to <a href="http://kb.site5.com/shell-access-ssh/how-to-generate-ssh-keys-and-login-to-your-account-with-ssh/?id=185945">generate SSH keys</a> to save your password so you don&#39;t have to enter it every time, if you haven&#39;t already.</li><li>Assuming that you&#39;re already in the same directory as the shell file, execute the command <code>bash gitsetup.sh</code> (or whatever you called your file). Enter the full path to the desired directory (e.g. <code>path/to/project</code>) when prompted. It will automatically set up the remote git repo for you. Disconnect with Ctrl+D.</li><li>If using <a href=https://blog.5apps.com/2014/05/29/deploying-static-apps-with-grunt-build-control-on-5apps-deploy.html>grunt-build-control</a> then follow <a href=http://curtisblackwell.com/blog/my-deploy-method-brings-most-of-the-boys-to-the-yard>Curtis Blackwell&#39;s instructions</a> for adding the remote URL to your Gruntfile. Else, add the new remote url to your local dev repo with <code>git remote add remotename username@hostname:path/to/project/.git/</code>.</li></ol><p>Now you can use <code>git push remotename master</code> (or <code>grunt deploy</code>) to deploy!</p><p>If you want to make things even easier, you can create even more shortcuts: For instance, I&#39;ve created a <a href="http://www.moncefbelyamani.com/create-aliases-in-bash-profile-to-assign-shortcuts-for-common-terminal-commands/">bash_profile alias</a> for the command to SSH into my staging directory, so that I don&#39;t need to remember and type the address to my server.</p></article></main><aside class="featuredPosts wrapper-small"><h3>Liked this post? You might like:</h3><ul class=fp_list><li class=fp_item><a class=thumb href="/arcus-redesign/" title="Case Study: Redesigning the Arcus mobile app"><img src=/img/blogThumbs/arcus.9bf7.png alt="Case Study: Redesigning the Arcus mobile app" width=279 height=92></a></li><li class=fp_item><a class=thumb href="/live-iss-screensaver/" title="ISS Screensaver"><img src=/img/blogThumbs/iss.2db5.jpg alt="ISS Screensaver" width=279 height=92></a></li><li class=fp_item><a class=thumb href="/doge/" title=Dogenerator><img src=/img/blogThumbs/dogenerator.e676.jpg alt=Dogenerator width=279 height=92></a></li></ul></aside><script id=config_tmpl type=text/template><div id="config">
		<div class="wrapper">
			<a class="configBtn" href="#" title="Close" role="button">&times;</a>
			<h3>Configure site options</h3>
			<section>
				<h4>Change theme</h4>
				<ul id="styleSwitcher">
				   <li><a class="on" href="#" id="standard"><i class="icon-check-empty"></i> Standard</a></li>
				   <li><a href="#" id="geocities"><i class="icon-check-empty"></i> Geocities</a></li>
				</ul>
			</section>
			<section>
				<h4>Modify link behaviour</h4>
				<ul id="linkSwitcher">
					<li><a href="#" class="on"><i class="icon-check-empty"></i> Open external links in a new tab</a></li>
				</ul>
			</section>
		</div>
	</div></script><script src=//code.jquery.com/jquery-1.11.0.min.js></script><script src=/js/main.8de0.js></script><div id=disqus_thread class=wrapper-small><noscript><p class=browsehappy>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></p></noscript></div><script type=text/javascript>var disqus_shortname = 'richardwestenra';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><footer class=footer><div class=wrapper><p class=contact><a href=mailto:richard@richardwestenra.com target=_blank><i class=icon-mail></i> richard@richardwestenra.com</a> <a href=http://twitter.com/richardwestenra target=_blank><i class=icon-twitter></i> @richardwestenra</a></p><p class=legal><span>&copy;</span> Copyleft: All wrongs reserved</p></div></footer></div></body></html>